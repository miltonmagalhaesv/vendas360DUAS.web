SELECT
  (CASE EXTRACT(MONTH FROM data_lanca)
      WHEN 1 THEN 'Janeiro' WHEN 2 THEN 'Fevereiro' WHEN 3 THEN 'Mar√ßo'
      WHEN 4 THEN 'Abril'   WHEN 5 THEN 'Maio'      WHEN 6 THEN 'Junho'
      WHEN 7 THEN 'Julho'   WHEN 8 THEN 'Agosto'    WHEN 9 THEN 'Setembro'
      WHEN 10 THEN 'Outubro' WHEN 11 THEN 'Novembro' WHEN 12 THEN 'Dezembro'
   END) AS mes,
  SUM(valor_item_nf) AS valor_total,
  'R$ ' || REPLACE(REPLACE(REPLACE(
      TO_CHAR(SUM(valor_item_nf), 'FM9G999G999G999G990D00')
    , ',', 'X'), '.', ','), 'X', '.') AS valor_total_fmt
FROM public.vw_analise_marcas
WHERE
  ( {{ !Select_Ano.selectedOptionValue }}
    OR EXTRACT(YEAR FROM data_lanca) = {{ Number(Select_Ano.selectedOptionValue) }} )
GROUP BY mes, EXTRACT(MONTH FROM data_lanca)
ORDER BY EXTRACT(MONTH FROM data_lanca);